<!DOCTYPE html>
<html>
  <head>
    <title>My first Chartist Tests</title>
    <link rel="stylesheet" href="chartist.min.css.gz">
    <style>
        .ct-chart{
            width: 90%;
            height: 300px;
        }
    </style>
</head>
<body>
  <h1> Weekly </h1>
  <div class="ct-chart chart1"></div>
  <h1> Monthly </h1>
  <div class="ct-chart chart2"></div>
  <h1> Log </h1>
  <div id="log"></div>
  <script >
    var chart;
    function load_chart( url , clazz ){
      var xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
          console.log(this.responseText);
          var series = JSON.parse(this.responseText);
          var data = { series: series   };
          chart = new Chartist.Line(clazz, data , {high: 30 , low: -25});
        }
      }
      xhttp.open("GET", url, true);
      xhttp.send();
    };
    function load_charts(){
      load_chart("/weekly" , ".chart1");
      load_chart("/monthly" , ".chart2");
    }
    var log = document.getElementById("log")

    function myCallback() {
      function get_log( ){
        var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function() {
          if (this.readyState == 4 && this.status == 200) {
            console.log(this.responseText);
            log.innerHTML += this.responseText;
          }
        }
        xhttp.open("GET", "/log", true);
        xhttp.send();
      };
    }
    var intervalID = window.setInterval(get_log, 1500);
  </script>
  <script  onload="load_charts();" src="/chartist.min.js.gz"> </script>

</body>
</html>
